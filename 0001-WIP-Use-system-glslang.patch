From 2ff2fe89f51ebfd6707d74cfff149e5d332c2764 Mon Sep 17 00:00:00 2001
From: Mystro256 <alexjnewt@hotmail.com>
Date: Thu, 12 Mar 2020 13:41:58 -0400
Subject: [PATCH] WIP: Use system glslang

---
 CMakeLists.txt                                   |  1 -
 Source/Core/VideoBackends/Vulkan/CMakeLists.txt  | 16 ----------------
 .../Core/VideoBackends/Vulkan/ShaderCompiler.cpp |  7 ++++---
 3 files changed, 4 insertions(+), 20 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index e6c242ba13..2394740791 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -541,7 +541,6 @@ else()
   add_subdirectory(Externals/fmt EXCLUDE_FROM_ALL)
 endif()
 
-add_subdirectory(Externals/glslang)
 add_subdirectory(Externals/imgui)
 
 find_package(pugixml)
diff --git a/Source/Core/VideoBackends/Vulkan/CMakeLists.txt b/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
index 87628030e9..c99b7a5595 100644
--- a/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
+++ b/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
@@ -41,22 +41,6 @@ target_link_libraries(videovulkan
 PUBLIC
   common
   videocommon
-
-PRIVATE
-  # Link against glslang, the other necessary libraries are referenced by the executable.
   glslang
   xxhash
 )
-
-# Only include the Vulkan headers when building the Vulkan backend
-target_include_directories(videovulkan
-PRIVATE
-  ${CMAKE_SOURCE_DIR}/Externals/Vulkan/Include
-)
-
-# Silence warnings on glslang by flagging it as a system include
-target_include_directories(videovulkan
-SYSTEM PRIVATE
-  ${CMAKE_SOURCE_DIR}/Externals/glslang/glslang/Public
-  ${CMAKE_SOURCE_DIR}/Externals/glslang/SPIRV
-)
diff --git a/Source/Core/VideoBackends/Vulkan/ShaderCompiler.cpp b/Source/Core/VideoBackends/Vulkan/ShaderCompiler.cpp
index 7b6beb11b0..47b03dfe15 100644
--- a/Source/Core/VideoBackends/Vulkan/ShaderCompiler.cpp
+++ b/Source/Core/VideoBackends/Vulkan/ShaderCompiler.cpp
@@ -13,9 +13,10 @@
 #include <string>
 
 // glslang includes
-#include "GlslangToSpv.h"
-#include "ShaderLang.h"
-#include "disassemble.h"
+#include "glslang/Include/BaseTypes.h"
+#include "glslang/SPIRV/GlslangToSpv.h"
+#include "glslang/Public/ShaderLang.h"
+#include "glslang/SPIRV/disassemble.h"
 
 #include "Common/FileUtil.h"
 #include "Common/Logging/Log.h"
-- 
2.21.1

