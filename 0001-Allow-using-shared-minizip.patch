From 9f12e0f5a9b282a92c8ee4e2fc4a94dc7a277bce Mon Sep 17 00:00:00 2001
From: Mystro256 <alexjnewt@hotmail.com>
Date: Wed, 11 Mar 2020 09:57:43 -0400
Subject: [PATCH 1/3] Allow using shared minizip

---
 CMakeLists.txt | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 02d6916d86..a46169b43c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -582,8 +582,14 @@ else()
   add_subdirectory(Externals/zlib)
 endif()
 
-add_subdirectory(Externals/minizip)
-include_directories(External/minizip)
+pkg_check_modules(MINIZIP minizip)
+if(MINIZIP_FOUND)
+  message(STATUS "Using shared minizip")
+else()
+  message(STATUS "Shared minizip not found, falling back to the static library")
+  add_subdirectory(Externals/minizip)
+  include_directories(External/minizip)
+endif()
 
 if(NOT APPLE)
   check_lib(LZO "(no .pc for lzo2)" lzo2 lzo/lzo1x.h QUIET)
-- 
2.21.1

